h2= t('login')

= form_for resource,
  as: :user,
  url: "/#{params[:locale]}/users/sign_in",
  data: {\
    controller: "passkey",
    "passkey-no-passkeys-found-value": tv(:no_passkeys_found),
    "passkey-email-missing-value": tv(:email_missing)\
  },
  html: { class: 'Form default' } do |f|

  = hidden_field_tag :path, @path
  - if @project
    = hidden_field_tag :project, @project.shortname

  .form-group
    .form-label
      = f.label :email,
        tv('activerecord.attributes.user.email'),
        class: 'FormLabel'
    .form-input
      = f.email_field :email,
        autofocus: true,
        autocomplete: "email",
        class: 'Input',
        data: { passkey_target: 'email' }

  .form-group
    .form-label
      = f.label :password,
        tv('activerecord.attributes.user.password'),
        class: 'FormLabel'
    .form-input
      = f.password_field :password,
        autocomplete: "current-password",
        class: 'Input'

  .Form-footer.u-mt
    = f.submit tv(:login),
      class: 'Button Button--primaryAction'
    = f.submit tv(:login_with_passkey),
      class: 'Button Button--secondaryAction u-ml',
      data: { action: "passkey#authenticate" }

.register-link
  = link_to tv('user.registration'),
    "#{@project.domain_with_optional_identifier}/#{@locale}?open_register_popup='true'",
    class: 'Link'

.order-new-password-link
  = link_to tv('forget_password'),
    "#{@project.domain_with_optional_identifier}/#{@locale}/users/password/new",
    class: 'Link'
